---
layout: post
title: 文字コードについて（概念の整理）
date: 2023/2/3
---
# はじめに
{% include_relative _prologue.md %}

本回は文字コード周辺の概念を整理します。

# 概念の整理
文字コードとその周辺の知識を理解する為には「符号化文字集合」「文字符号化方式」などの概念を最初に理解しておかないと混乱する事になります。
そこで、まずは、「アルファベット」「ひらがな」「カタカナ」などの文字集合が、計算機上の表現やネットワーク伝送形式として利用される為に、次の四段階のレベルがあることを理解します。

<img src="assets/standard-level.svg" alt="概念" width="800px" />

## 抽象文字集合（ＡＣＲ）
《 単純な文字の集合 》<br/>
「抽象文字集合」あるいは単に「文字集合（文字セット）」は、その名の通り、文字の集合を指します。とくに難しい概念ではありません。「アルファベット」も「５０音」も文字集合の一種です。

## 符号化文字集合（ＣＣＳ）

《 ひとつひとつの文字を区別できるようにする為に、文字にユニークな番号を採番した文字集合 》<br/>
前述の抽象文字集合はあくまで文字の「集まり」を指しているだけです。
計算機で文字を扱うには、文字を区別する為に、文字にユニークな番号が採番されていないと不便です。
ちょうど学校のクラスで生徒に出席番号を振るのと同じように、一つ一つの文字にもユニークな番号を採番します。
各文字にユニークな番号を採番した文字集合のことを符号化文字集合といいます。
日本語の場合、JIS X 0201、JIS X 0208、JIS X 0212、JIS X 0213と呼ばれている規格が符号化文字集合です。
Unicode では 0x0 - 0x10FFFF (16進数) の範囲に文字が採番されています。

なお、採番した番号の事を「コードポイント」あるいは「句点位置」と呼びます。

## 文字符号化形式（ＣＥＦ）
《 文字列を計算機のメモリ上で扱いやすい形式に変換する為の方式(符号化方式) 》<br/>
符号化文字集合として、Unicode 文字は 0x0-0x10FFFF の範囲に採番されていて 21bit の範囲で表現されます。
しかし、計算機は 21bit というデータサイズをそのまま扱うのは苦手です。計算機が、メモリ上でデータを扱う為には、通常、BYTE(8bit)、WORD(16bit)、DWORD(32bit) などの 8 の倍数のデータ型で扱う必要があります。
つまり文字列を計算機で扱う為には、8bit/16bit/32bitの箱の配列に変換する必要があります。
この変換作業のことを「エンコード」あるいは「符号化」と呼びます。

文字符号化形式は、このエンコードのルールを規定したもので、UTF-8, UTF-16, UTF-32 と呼ばれている規格があります。

## 文字符号化スキーム（ＣＥＳ）
《 文字列をファイルに保存したりネットワークに流したりする形式に変換する為の方式(符号化方式) 》<br/>
文字列をファイルに保存したり、ネットワークに伝送したりする場合は、計算機のメモリ上で扱うのとは別の符号化のルールが必要です。
なぜなら、ファイルに保存したりネットワークに伝送する場合には、16bit や 32bitの配列はそのまま保存できませんので、8bit の配列（直列化=シリアライズ）にする必要があるからです。
文字符号化スキームは、ファイルに保存したりネットワークの伝送に使用することを目的に、8bit の配列に直列化する為のルールです。
UTF-8, UTF-16LE, UTF-16BE, UTF-32LE, UTF-32BE と呼ばれている規格があります。

## コードポイントと文字コード
《 コードポイント 》<br/>
符号化文字集合では、一つ一つの文字には出席番号みたいに番号を持ちます。
この番号のことをコードポイント（符号位置・区点位置）と呼びます。Unicode では、0x0 - 0x10FFFF (16進数)の範囲で採番されています。また JIS X 0208 では 94 個の「区」と 94 個の「点」で定義されています。
ここで「コードポイント」はあくまで机上で採番した単なる出席番号であって、計算機上のメモリ値とは異なりますので注意してください。

《 文字コード 》<br/>
文字コードという用語は幾つかの意味があります。符号化文字集合や文字符号化方式をまとめた規則体系を表わして「文字コード」と呼ぶ場合もありますし、
文脈によっては計算機のメモリ上で表現されているデータの値を指して文字コードと呼びます。

(例)
 - そのファイルの文字コードは？ (体系を聞いている)
 - 「あ」の文字コードは SJIS でいくつ？ (データ値を聞いている)

## エンコード（符号化）とエンコーディング
《 エンコード（符号化） 》<br/>
「エンコード」あるいは「符号化」とは、データを一定のルールに基づいて変換することを指します。
符号化文字集合の各文字を文字符号化形式や文字符号化スキームのルールに基づいて変換することをエンコード（符号化）と呼びます。
また「エンコードする」と「符号化する」は同じ意味で使われます。

《 エンコーディング 》<br/>
「エンコーディング」は、符号化の方式を意味します。JIS, Shift-Jis, UTF-8, UTF-16 などはエンコーディングの規格です。


